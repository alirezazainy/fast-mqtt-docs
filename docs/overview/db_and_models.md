# **مستندات فنی**

## **دیتابیس و مدل ها**

### **دیتابیس**

- _اسناد [**SQLAlchemy**](https://docs.sqlalchemy.org/)_

ساختار دیتابیس این نرم افزار به شکل زیر است: 
> اضافه کردن دیتابیس دیاگرام

??? success "نحوه اتصال به دیتابیس"
    برای ارتباط با دیتابیس از کتابخانه SQLAlchemy استفاده شده.

با توجه به این که این نرم افزار صرفا درخواست ها را ذخیره میکند نیازی به ایجاد چند جدول نبود و یک جدول برای ثبت رکورد ها کافی است.

- جدول مورد نظر سه مقدار دارد که با توجه به درخواست ها پر می شوند:

    * IMEI: این مقدار شناسه دستگاه هدف را ذخیره کرده و مشخص میکند چه دستگاهی درخواست مورد نظر را باید انجام دهد.

    * micro_op: این مقدار عملیات درخواستی را ذخیره میکند.

    * time_stamp: این مقدار ساعت عملیات مورد نظر را ثبت می کند و به صورت اتوماتیک پر می شود.

=== "کد فایل models.py" 
    ```{.py .no-copy}
    class Message(Base):
        __tablename__ = "Messages"

        ID = Column(Integer, index=True, primary_key=True)
        imei = Column(String, nullable=False)
        micro_op = Column(String, nullable=False)
        time_stamp = Column(DateTime, default=func.now())
    ```


### **شمای کلی درخواست ها**
 
درخواست های مورد نظر از سمت کاربر یه صورت یک درخواست json ارسال می شود:

=== "کد request.json"
    ```json
    {
        "imei":"26372637216372637126376237", // کد شناسایی دستگاهی که در حال درخواست کردن می باشد
        "micro_op":"push_down" // عملیاتی که نیاز به انجام دادن آن دارید
    }
    ```
درخواست بالا در برنامه به شکل کلاس زیر ترجمه شده و به کنترلر فرستاده می شود: 

=== "کد schemas.py"
    ```{.py .no-copy}
    class MessageBaseModel(BaseModel):
        imei: str
        micro_op: str
    ```